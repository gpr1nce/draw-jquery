var draw=function(){var e=document.querySelector("main").offsetWidth,t=document.querySelector("main").offsetHeight,n=document.createElement("canvas"),o=n.getContext("2d"),r=n.getBoundingClientRect(),i=0,a=0,l=0,d=0,c=0,s=0,u=!1,g=!1,h="",f=!1,w="",m="",S=[],C=0;return{setXY:function(e){u=i,g=a,i=e.clientX-r.left-n.offsetLeft,a=e.clientY-r.top-n.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+i,document.getElementById("trackY").innerHTML="Y: "+a},setStart:function(){l=i,d=a},setEnd:function(){c=i,s=a},setPoint:function(){S[C]=[],S[C].x=i,S[C].y=a,S.length>2?(this.draw(),C=0,S=[]):C++},setShape:function(e){h=e},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStrokeColor:function(e){w=e},getStrokeColor:function(){return w.length>6?w:this.randColor()},setFillColor:function(e){m=e},getFillColor:function(){return m.length>6?m:this.randColor()},setIsDrawing:function(e){f=e},getIsDrawing:function(){return f},draw:function(){o.restore(),"rectangle"===h?this.drawRect():"line"===h?this.drawLine():"circle"===h?this.drawCircle():"path"===h?this.drawPath():"triangle"===h?this.drawTriangle():"3-point"===h?this.draw3Point():alert("Please choose a shape"),o.save()},drawRect:function(){o.fillStyle=this.getFillColor(),o.fillRect(l,d,c-l,s-d),o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.stroke(),o.fill()},drawLine:function(){o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(l,d),o.lineTo(c,s),o.stroke()},drawCircle:function(){o.strokeStyle=this.getStrokeColor(),o.fillStyle=this.getFillColor();let e=l-c,t=d-s,n=Math.sqrt(e*e+t*t);o.beginPath(),o.arc(l,d,n,0,2*Math.PI),o.stroke(),o.fill()},drawPath:function(){o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(u,g),o.lineTo(i,a),o.stroke()},drawTriangle:function(){var e=l-c,t=d-s,n=Math.sqrt(e*e+t*t),r=l+n,i=d+n;l>c&&(r=l-n),d>s&&(i=d-n),o.fillStyle=this.getFillColor(),o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(l,d),o.lineTo(r,i),o.lineTo(c,s),o.lineTo(l,d),o.stroke(),o.fill()},draw3Point:function(){o.fillStyle=this.getFillColor(),o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(S[0].x,S[0].y),o.lineTo(S[1].x,S[1].y),o.lineTo(S[2].x,S[2].y),o.lineTo(S[0].x,S[0].y),o.stroke(),o.fill()},getShape:function(){return h},getCanvas:function(){return n},init:function(){n.width=e,n.height=t,document.querySelector("main").appendChild(n),document.getElementById("trackX").innerHTML="X: 0",document.getElementById("trackY").innerHTML="Y: 0"}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")},!1),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")},!1),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")},!1),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")},!1),document.getElementById("btnTriangle").addEventListener("click",function(){draw.setShape("triangle")},!1),document.getElementById("btn3Point").addEventListener("click",function(){draw.setShape("3-point")}),draw.getCanvas().addEventListener("mousemove",function(e){draw.setXY(e),draw.writeXY(),"path"==draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()},!1),draw.getCanvas().addEventListener("mouseleave",function(){document.getElementById("trackX").innerHTML="X: 0",document.getElementById("trackY").innerHTML="Y: 0",draw.setIsDrawing(!1)},!1),draw.getCanvas().addEventListener("mousedown",function(){"3-point"!==draw.getShape()&&(draw.setStart(),draw.setIsDrawing(!0))},!1),draw.getCanvas().addEventListener("mouseup",function(){"3-point"!==draw.getShape()&&(draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)),"3-point"===draw.getShape()&&draw.setPoint()},!1),document.getElementById("strokeColor").addEventListener("change",function(){draw.setStrokeColor(document.getElementById("strokeColor").value)}),document.getElementById("randStrokeColor").addEventListener("change",function(){draw.setStrokeColor("")}),document.getElementById("fillColor").addEventListener("change",function(){draw.setFillColor(document.getElementById("fillColor").value)}),document.getElementById("randFillColor").addEventListener("change",function(){draw.setFillColor("")});